<!DOCTYPE html>
<html>
<head>
    <title>–ì–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial; background: black; color: white; padding: 20px; text-align: center; }
        .container { max-width: 400px; margin: 50px auto; background: #222; padding: 30px; border-radius: 10px; }
        input, button { width: 100%; padding: 15px; margin: 10px 0; font-size: 16px; }
        input { background: #333; color: white; border: 1px solid #555; }
        button { background: #28a745; color: white; border: none; cursor: pointer; }
        button:hover { background: #218838; }
        #chat { display: none; margin-top: 20px; }
        .status { padding: 10px; margin: 10px 0; }
        .online { background: #155724; }
        .offline { background: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé§ –ì–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç</h1>
        <p>–°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç—É –∏ –ø–æ–∑–æ–≤–∏—Ç–µ –¥—Ä—É–≥–∞</p>
        
        <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è" value="–Ø">
        <input type="text" id="room" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã" value="–∫–æ–º–Ω–∞—Ç–∞123">
        
        <button onclick="startChat()">–í–æ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É</button>
        
        <div id="chat">
            <div class="status offline" id="status">–û—Ç–∫–ª—é—á–µ–Ω–æ</div>
            <p><strong>–ö–æ–º–Ω–∞—Ç–∞:</strong> <span id="roomName"></span></p>
            <p><strong>–£—á–∞—Å—Ç–Ω–∏–∫–∏:</strong> <span id="users">1</span></p>
            
            <button onclick="toggleMic()" id="micBtn">üé§ –í–∫–ª</button>
            <button onclick="leaveRoom()" style="background:#dc3545;">–í—ã–π—Ç–∏</button>
            
            <p style="margin-top:20px;word-break:break-all;">
                <strong>–°—Å—ã–ª–∫–∞ –¥–ª—è –¥—Ä—É–≥–∞:</strong><br>
                <span id="link"></span>
            </p>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –≥–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç
        let localStream = null;
        let isMuted = false;
        
        async function startChat() {
            const name = document.getElementById('name').value || '–ì–æ—Å—Ç—å';
            const room = document.getElementById('room').value || '–∫–æ–º–Ω–∞—Ç–∞';
            
            try {
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω
                localStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —á–∞—Ç
                document.getElementById('chat').style.display = 'block';
                document.getElementById('roomName').textContent = room;
                document.getElementById('status').className = 'status online';
                document.getElementById('status').textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
                
                // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É
                const link = window.location.href.split('?')[0] + '?room=' + encodeURIComponent(room);
                document.getElementById('link').textContent = link;
                
                // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –≤—Ö–æ–¥–µ
                alert('‚úÖ –í—ã –≤–æ—à–ª–∏ –≤ –∫–æ–º–Ω–∞—Ç—É!\n\n–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∏–∂–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–≥—É.\n\n–ö–æ–≥–¥–∞ –¥—Ä—É–≥ –æ—Ç–∫—Ä–æ–µ—Ç —Å—Å—ã–ª–∫—É, –≤—ã —Å–º–æ–∂–µ—Ç–µ –æ–±—â–∞—Ç—å—Å—è!');
                
            } catch(err) {
                alert('‚ùå –û—à–∏–±–∫–∞: ' + err.message);
                document.getElementById('status').className = 'status offline';
                document.getElementById('status').textContent = '‚ùå –û—à–∏–±–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞';
            }
        }
        
        function toggleMic() {
            if (!localStream) return;
            isMuted = !isMuted;
            localStream.getAudioTracks()[0].enabled = !isMuted;
            document.getElementById('micBtn').textContent = isMuted ? 'üîá –í—ã–∫–ª' : 'üé§ –í–∫–ª';
        }
        
        function leaveRoom() {
            if (localStream) {
                localStream.getTracks().forEach(track => track.stop());
            }
            document.getElementById('chat').style.display = 'none';
            document.getElementById('status').className = 'status offline';
            document.getElementById('status').textContent = '–û—Ç–∫–ª—é—á–µ–Ω–æ';
        }
        
        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            const room = params.get('room');
            if (room) {
                document.getElementById('room').value = room;
                // –ú–æ–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–∞—Ç
                // startChat();
            }
        };
    </script>
</body>
</html>
